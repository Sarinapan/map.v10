<!DOCTYPE html>
<html>
    <head>
        <title>Whitby</title>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
        <meta charset="utf-8">
        <style>
            html, body {
                height: 100%;
                margin: 0;
                padding: 0;
            }
            #map {
                height: 100%;
            }
        </style>
    </head>
    <body>
        <div id="map"></div>
        <script>
            var map;
    function initMap() { 
        map = new google.maps.Map(document.getElementById('map'), {
          center: new google.maps.LatLng(-41.1130274, 174.8924949),
          zoom: 15,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        });
            
//-----------------------------------------------------------------------------------------------
//City Location 
        var citymap = {
            well: {
                center: {lat: -41.2865, lng: 174.7762}, 
                rad: 20,
                name: 'Wellington'
            },
            petone: {
                center: {lat: -41.2270, lng: 174.8851},
                rad: 20,
                name: 'Petone'
            },
            lwrhutt: {
                center: {lat: -41.2092, lng: 174.9081},
                rad: 20,
                name: 'Lower Hutt'
            },
            whitby: {
                center: {lat: -41.1130274, lng: 174.8924949},
                rad: 20,
                name: 'Whitby'
            }
        }; 
        
        
//-----------------------------------------------------------------------------------------------        
        function CenterControl(controlDiv, map, latLong, name) {
            var controlUI = document.createElement('div');
            var controlText = document.createElement('div');          
            setUIStyle(controlUI, controlDiv);
            setTextStyle(controlText, controlUI, name);
            actionPerform(controlUI, map, latLong);
        }    
        function setUIStyle(ui, div){
            ui.style.backgroundColor = '#fff';
            ui.style.border = '2px solid #fff';
            ui.style.borderRadius = '3px';
            ui.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
            ui.style.cursor = 'pointer';
            ui.style.marginBottom = '22px';
            ui.style.textAlign = 'center';
            ui.title = 'Click to recenter the map';
            div.appendChild(ui);
        }   

        function setTextStyle(text, ui, cityName){
            text.style.color = 'rgb(25,25,25)';
            text.style.fontFamily = 'Roboto,Arial,sans-serif';
            text.style.fontSize = '10px';
            text.style.lineHeight = '38px';
            text.style.paddingLeft = '5px';
            text.style.paddingRight = '5px';
            text.innerHTML = cityName;
            ui.appendChild(text);
        }
        
        function actionPerform(controlUI, map, latLong){
            controlUI.addEventListener('click', function(){
                map.setCenter(latLong);
            });
        }
               
        var centerControlDiv = document.createElement('div');
        var centerControl = new CenterControl(centerControlDiv, map, citymap.well.center, citymap.well.name);
        var centerControl = new CenterControl(centerControlDiv, map, citymap.petone.center, citymap.petone.name);
        var centerControl = new CenterControl(centerControlDiv, map, citymap.whitby.center, citymap.whitby.name);
        var centerControl = new CenterControl(centerControlDiv, map, citymap.lwrhutt.center, citymap.lwrhutt.name);
        centerControlDiv.index = 1;
        map.controls[google.maps.ControlPosition.TOP_RIGHT].push(centerControlDiv);
//-----------------------------------------------------------------------------------------------
//ExpandingZone
        var cityCircle = [];
                
        for (var city in citymap) {
            var circle = new google.maps.Circle({
                strokeColor: '#FF0000',
                strokeOpacity: 0.8,
                strokeWeight: 2,
                fillColor: '#FF0000',
                fillOpacity: 0.35,
                map: map,
                center: citymap[city].center,
                radius: Math.sqrt(citymap[city].rad),
            });
            cityCircle.push(circle);
        }
                 
        var expansionDirection = 1;
        var timeDelay = 50, maxRad = 190;
        var initEscape = 100;  
        setInterval(function ()
        {
            var radius;
            for(var i = 0; i < cityCircle.length; i++){
                radius = cityCircle[i].getRadius();
                if (radius < timeDelay)
                {
                    expansionDirection;
                } 
                else if (radius >= maxRad)
                {
                    expansionDirection = 0;
                }
                if (radius <= initEscape)
                {
                    cityCircle[i].setRadius(radius + expansionDirection * 1.0);
                } 
                else if (radius >= initEscape)
                {
                    cityCircle[i].setRadius(radius + expansionDirection * 0.5);
                }
            }
        }, 50);
//-----------------------------------------------------------------------------------------------
//Placing Cordons
        var num = (function() { //counter
            var count = 1;   
            return function() { return count++; };  
        })(); 
                
        var markers = [];
        for (var city in citymap){
            var marker = new google.maps.Marker({
            position: citymap[city].center,
            map: map            
        });
        markers.push(marker);
    }
        map.addListener('click', function(event) {
            addMarker(event.latLng);
        });
        
        function addMarker(location) {
            var marker = new google.maps.Marker({
            position: location,
            map: map,
            icon: 'policeCar.ico'
        });
        var unit = new google.maps.InfoWindow({
            content: 'WLT ' + num()});
            unit.open(map,marker);
            markers.push(marker); //add marker to array
        }

        /*function setMapOnAll(map) {
            for (var i = 0; i < markers.length; i++) {
                markers[i].setMap(map);
            }
        }*/
    }// end initMap() do not add code below this closing bracket
//--------------------------------------------------------------------------------------------
        google.maps.event.addDomListener(window, 'load', initialize);
        </script>
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBmE4K2a37cqq8wdmkTudyrRkDVbNEtx-4&callback=initMap"
        async defer></script>
    </body>
</html>
